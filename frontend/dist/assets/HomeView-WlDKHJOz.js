import{u as N,r as g,o as L,c as v,a as c,b as t,d as P,e as u,f as y,g as h,w as i,h as r,i as l,R as n,F as x,j as b,t as p,k as a}from"./index-CbeUM-tk.js";import{f as S}from"./jobs-BugcPTwM.js";const V={class:"space-y-6"},C={class:"grid gap-6 rounded-2xl border bg-white p-6 shadow md:grid-cols-3"},A={class:"md:col-span-2 space-y-6"},J={class:"mt-4 flex flex-wrap gap-3"},M={class:"tile flex flex-col rounded-2xl border bg-white p-4"},I={class:"my-3 max-h-48 space-y-2 overflow-y-auto pr-1"},R={class:"font-semibold text-slate-900"},T={class:"text-xs text-slate-500"},G={key:0,class:"mt-auto space-y-2 pt-3"},U={class:"mt-4 rounded-2xl border p-3"},H={class:"space-y-1 text-sm text-slate-600"},q={class:"grid gap-3 md:grid-cols-4"},Q={__name:"HomeView",setup(E){const w=["🔧 Improved job matching accuracy","💸 This week: 10% off delivery fees (Fri-Sun)","🗺️ Live tracking accuracy upgrades","🗓️ Tip: Use job # to search","🛡️ New fraud checks for payouts"],k=[{id:"demo-1",price:72,pickup_label:"Camden",dropoff_label:"Croydon"},{id:"demo-2",price:60,pickup_label:"Reading",dropoff_label:"Guildford"},{id:"demo-3",price:120,pickup_label:"Leeds",dropoff_label:"Bradford"}],_=[{to:"/jobs",label:"Jobs"},{to:"/messages",label:"Messages"},{to:"/planner",label:"Planner"},{to:"/invoices",label:"Invoices"},{to:"/profile",label:"Profile"}],d=N(),m=g([]),f=g(!1);L(async()=>{!d.user&&d.token&&await d.fetchMe().catch(()=>null),f.value=!0;try{const o=await S();m.value=Array.isArray(o==null?void 0:o.jobs)?o.jobs:[]}catch(o){console.error("Failed to load highlight jobs",o),m.value=[]}finally{f.value=!1}});const j=v(()=>{var e;return((e=m.value)!=null&&e.length?m.value:k).slice(0,3)}),B=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",maximumFractionDigits:0}),D=v(()=>_.filter(o=>o.to!=="/planner"?!0:d.hasPlannerAccess));return(o,e)=>(a(),c("div",V,[t("section",C,[t("div",A,[t("div",null,[e[3]||(e[3]=t("h1",{class:"text-3xl font-extrabold text-slate-900"},"Welcome to MotorRelay",-1)),e[4]||(e[4]=t("p",{class:"mt-2 text-slate-600"}," Connect dealerships with trusted delivery drivers. Post jobs, accept runs, and get paid fast. ",-1)),t("div",J,[u(l(n),{to:"/jobs",class:"tile inline-flex items-center gap-2 rounded-xl bg-emerald-500 px-4 py-2 text-white shadow-sm hover:bg-emerald-600"},{default:i(()=>[...e[0]||(e[0]=[r(" Find Jobs ",-1)])]),_:1}),l(d).isDealer||l(d).role==="admin"?(a(),y(l(n),{key:0,to:"/jobs/new",class:"tile inline-flex items-center gap-2 rounded-xl border bg-white px-4 py-2 text-emerald-700 shadow-sm hover:bg-slate-50"},{default:i(()=>[...e[1]||(e[1]=[r(" Create Job ",-1)])]),_:1})):h("",!0),u(l(n),{to:"/membership",class:"tile inline-flex items-center gap-2 rounded-xl border bg-white px-4 py-2 text-emerald-700 shadow-sm hover:bg-slate-50"},{default:i(()=>[...e[2]||(e[2]=[r(" Membership ",-1)])]),_:1})])]),e[5]||(e[5]=P('<div class="grid grid-cols-2 gap-4 md:grid-cols-3"><div class="tile rounded-2xl bg-emerald-50 p-4"><div class="font-semibold text-emerald-900">Post or accept runs</div><div class="text-sm text-emerald-700">Dealers post, drivers deliver.</div></div><div class="tile rounded-2xl bg-emerald-50 p-4"><div class="font-semibold text-emerald-900">Built-in messaging</div><div class="text-sm text-emerald-700">Keep chats tidy.</div></div><div class="tile rounded-2xl bg-emerald-50 p-4"><div class="font-semibold text-emerald-900">Instant invoices</div><div class="text-sm text-emerald-700">One click to print.</div></div></div>',1))]),t("aside",M,[e[11]||(e[11]=t("div",{class:"mb-2 flex items-center justify-between"},[t("div",{class:"font-bold text-slate-900"},"Start earning today"),t("span",{class:"rounded-lg bg-emerald-100 px-2 py-1 text-xs text-emerald-700"},"Drivers & Dealers")],-1)),e[12]||(e[12]=t("p",{class:"text-sm text-slate-600"}," See jobs near you and sign up in minutes. ",-1)),t("div",I,[(a(!0),c(x,null,b(j.value,s=>(a(),c("div",{key:s.id,class:"flex items-center justify-between rounded-xl border bg-white/80 p-3"},[t("div",null,[t("div",R,p(l(B).format(Number(s.price??0))),1),t("div",T,[r(p(s.pickup_label||"Pickup")+" ",1),e[6]||(e[6]=t("span",{"aria-hidden":"true",class:"px-1 text-slate-300"},"→",-1)),r(" "+p(s.dropoff_label||"Drop-off"),1)])]),u(l(n),{to:`/jobs/${s.id}`,class:"rounded-lg bg-emerald-500 px-3 py-1 text-xs font-semibold text-white hover:bg-emerald-600"},{default:i(()=>[...e[7]||(e[7]=[r(" View ",-1)])]),_:1},8,["to"])]))),128))]),l(d).isAuthenticated?h("",!0):(a(),c("div",G,[u(l(n),{to:"/signup",class:"block w-full rounded-xl bg-emerald-500 px-3 py-2 text-center text-sm font-semibold text-white hover:bg-emerald-600"},{default:i(()=>[...e[8]||(e[8]=[r(" Sign up ",-1)])]),_:1}),u(l(n),{to:"/login",class:"block w-full rounded-xl border px-3 py-2 text-center text-sm font-semibold text-slate-700 hover:bg-slate-50"},{default:i(()=>[...e[9]||(e[9]=[r(" Login ",-1)])]),_:1})])),t("div",U,[e[10]||(e[10]=t("div",{class:"mb-1 font-semibold text-slate-900"},"Updates",-1)),t("ul",H,[(a(),c(x,null,b(w,(s,F)=>t("li",{key:F},p(s),1)),64))])])])]),t("section",q,[(a(!0),c(x,null,b(D.value,s=>(a(),y(l(n),{key:s.to,to:s.to,class:"tile rounded-2xl border bg-white px-4 py-3 text-left font-semibold text-slate-900 shadow-sm hover:bg-slate-50"},{default:i(()=>[r(p(s.label),1)]),_:2},1032,["to"]))),128))])]))}};export{Q as default};
