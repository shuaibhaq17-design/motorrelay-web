import{u as g,l as w,r as m,a as r,b as t,e as v,p as c,v as p,t as h,m as k,h as f,f as q,w as M,i as R,R as V,q as _,z as S,k as n,y as L}from"./index-17v5VSGm.js";const N={class:"mx-auto w-full max-w-3xl space-y-8 rounded-3xl border border-slate-200 bg-white p-6 sm:p-8 lg:p-10"},C={key:0,class:"text-sm text-red-600"},j=["disabled"],A={key:0},B={key:1},T={class:"text-sm text-slate-600"},U={__name:"LoginView",setup(D){const x=_(),i=S(),d=g(),o=w({email:"",password:""}),l=m(!1),a=m("");async function b(){var u,s;l.value=!0,a.value="";try{const{data:e}=await L.post("/auth/login",o);d.setSession({token:(e==null?void 0:e.token)||null,user:(e==null?void 0:e.user)||null,plan:(e==null?void 0:e.plan)||null,jobs:(e==null?void 0:e.jobs)??void 0}),await d.fetchMe();const y=typeof i.query.redirect=="string"&&i.query.redirect?i.query.redirect:"/";x.replace(y)}catch(e){console.error("Login failed",e),a.value=((s=(u=e.response)==null?void 0:u.data)==null?void 0:s.message)||"Login failed. Check your credentials."}finally{l.value=!1}}return(u,s)=>(n(),r("div",N,[s[6]||(s[6]=t("header",null,[t("h1",{class:"text-2xl font-bold text-slate-900"},"Log in"),t("p",{class:"text-sm text-slate-600"}," Access your MotorRelay account to manage jobs and messaging. "),t("p",{class:"mt-2 text-xs text-slate-500"}," A valid login is required to view the dashboard, planner, and profiles. If you do not have access, contact your MotorRelay admin. ")],-1)),t("form",{class:"space-y-4",onSubmit:k(b,["prevent"])},[t("div",null,[s[2]||(s[2]=t("label",{class:"text-sm font-semibold text-slate-700"},"Email",-1)),c(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>o.email=e),type:"email",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[p,o.email]])]),t("div",null,[s[3]||(s[3]=t("label",{class:"text-sm font-semibold text-slate-700"},"Password",-1)),c(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>o.password=e),type:"password",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[p,o.password]])]),a.value?(n(),r("p",C,h(a.value),1)):v("",!0),t("button",{type:"submit",class:"w-full rounded-xl bg-emerald-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:l.value},[l.value?(n(),r("span",A,"Signing in...")):(n(),r("span",B,"Sign in"))],8,j)],32),t("p",T,[s[5]||(s[5]=f(" New to MotorRelay? ",-1)),q(R(V),{to:"/signup",class:"font-semibold text-emerald-600 hover:underline"},{default:M(()=>[...s[4]||(s[4]=[f(" Create an account ",-1)])]),_:1})])]))}};export{U as default};
