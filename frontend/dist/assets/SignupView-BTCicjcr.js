import{u as q,l as y,r as v,s as V,a as u,b as l,e as x,p as i,v as d,H as c,t as C,m as U,h as w,f as D,w as S,i as _,R as M,q as P,k as p,y as A}from"./index-17v5VSGm.js";const T={class:"mx-auto w-full max-w-3xl space-y-8 rounded-3xl border border-slate-200 bg-white p-6 sm:p-8 lg:p-10"},E={class:"grid gap-4 md:grid-cols-2"},B={key:0},R={key:0,class:"space-y-4"},L={class:"grid gap-4 md:grid-cols-2"},N={key:1,class:"space-y-4"},O={class:"grid gap-4 md:grid-cols-2"},G={class:"grid gap-4 md:grid-cols-2"},F={key:2,class:"text-sm text-red-600"},H=["disabled"],I={key:0},z={key:1},J={class:"text-sm text-slate-600"},W={__name:"SignupView",setup(K){const k=P(),g=q(),s=y({name:"",email:"",password:"",role:"driver",plan:"Starter",phone:"",company:"",address_line_one:"",address_line_two:"",city:"",postcode:"",company_number:"",passport_number:"",driver_dvla_code:""}),f=v(!1),b=v(""),o=y({trade_policy_document:null,trade_plate_photo:null,utility_bill:null,passport_selfie:null,driver_utility_bill:null,driver_license_front:null,driver_license_back:null,driver_passport:null,driver_selfie:null});async function j(){var m,e;f.value=!0,b.value="";try{const t=new FormData;Object.entries(s).forEach(([a,n])=>{n!=null&&n!==""&&t.append(a,n)}),s.role==="dealer"?Object.entries(o).forEach(([a,n])=>{["trade_policy_document","trade_plate_photo","utility_bill","passport_selfie"].includes(a)&&n&&t.append(a,n)}):s.role==="driver"&&Object.entries(o).forEach(([a,n])=>{["driver_utility_bill","driver_license_front","driver_license_back","driver_passport","driver_selfie"].includes(a)&&n&&t.append(a,n)});const{data:r}=await A.post("/auth/register",t,{headers:{"Content-Type":"multipart/form-data"}});g.setSession({token:(r==null?void 0:r.token)||null,user:(r==null?void 0:r.user)||null,plan:(r==null?void 0:r.plan)||null}),await g.fetchMe().catch(()=>null),k.push("/onboarding")}catch(t){console.error("Signup failed",t),b.value=((e=(m=t.response)==null?void 0:m.data)==null?void 0:e.message)||"Sign up failed. Try again later."}finally{f.value=!1}}return V(()=>s.role,m=>{m!=="dealer"&&(s.company="",s.address_line_one="",s.address_line_two="",s.city="",s.postcode="",s.company_number="",o.trade_policy_document=null,o.trade_plate_photo=null,o.utility_bill=null,o.passport_selfie=null),m!=="driver"&&(s.driver_dvla_code="",o.driver_utility_bill=null,o.driver_license_front=null,o.driver_license_back=null,o.driver_passport=null,o.driver_selfie=null)}),(m,e)=>(p(),u("div",T,[e[55]||(e[55]=l("header",null,[l("h1",{class:"text-2xl font-bold text-slate-900"},"Create your MotorRelay account"),l("p",{class:"text-sm text-slate-600"},"Drivers and dealers join to post, accept and track jobs.")],-1)),l("form",{class:"space-y-4",onSubmit:U(j,["prevent"])},[l("div",null,[e[24]||(e[24]=l("label",{class:"text-sm font-semibold text-slate-700"},"Full name",-1)),i(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.name=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[d,s.name]])]),l("div",null,[e[25]||(e[25]=l("label",{class:"text-sm font-semibold text-slate-700"},"Email",-1)),i(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.email=t),type:"email",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[d,s.email]])]),l("div",null,[e[26]||(e[26]=l("label",{class:"text-sm font-semibold text-slate-700"},"Password",-1)),i(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.password=t),type:"password",minlength:"8",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[d,s.password]])]),l("div",null,[e[28]||(e[28]=l("label",{class:"text-sm font-semibold text-slate-700"},"Role",-1)),i(l("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.role=t),class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},[...e[27]||(e[27]=[l("option",{value:"driver"},"Driver",-1),l("option",{value:"dealer"},"Dealer",-1)])],512),[[c,s.role]])]),l("div",E,[l("div",null,[e[29]||(e[29]=l("label",{class:"text-sm font-semibold text-slate-700"},"Phone",-1)),i(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.phone=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"07123 456789"},null,512),[[d,s.phone]])]),s.role==="dealer"?(p(),u("div",B,[e[30]||(e[30]=l("label",{class:"text-sm font-semibold text-slate-700"},"Company name",-1)),i(l("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.company=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"MotorRelay Motors"},null,512),[[d,s.company]])])):x("",!0)]),s.role==="dealer"?(p(),u("div",R,[l("div",null,[e[31]||(e[31]=l("label",{class:"text-sm font-semibold text-slate-700"},"Company number",-1)),i(l("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>s.company_number=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"12345678"},null,512),[[d,s.company_number]])]),l("div",null,[e[32]||(e[32]=l("label",{class:"text-sm font-semibold text-slate-700"},"Address line 1",-1)),i(l("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.address_line_one=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"Unit 12, Industrial Estate"},null,512),[[d,s.address_line_one]])]),l("div",null,[e[33]||(e[33]=l("label",{class:"text-sm font-semibold text-slate-700"},"Address line 2 (optional)",-1)),i(l("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>s.address_line_two=t),type:"text",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"Business Park"},null,512),[[d,s.address_line_two]])]),l("div",null,[e[34]||(e[34]=l("label",{class:"text-sm font-semibold text-slate-700"},"City",-1)),i(l("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>s.city=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"Manchester"},null,512),[[d,s.city]])]),l("div",null,[e[35]||(e[35]=l("label",{class:"text-sm font-semibold text-slate-700"},"Postcode",-1)),i(l("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>s.postcode=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"M1 2AB"},null,512),[[d,s.postcode]])]),l("div",null,[e[36]||(e[36]=l("label",{class:"text-sm font-semibold text-slate-700"},"Passport number",-1)),i(l("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>s.passport_number=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"123456789"},null,512),[[d,s.passport_number]])]),l("div",L,[l("div",null,[e[37]||(e[37]=l("label",{class:"text-sm font-semibold text-slate-700"},"Trade policy document",-1)),l("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[12]||(e[12]=t=>{var r;return o.trade_policy_document=((r=t.target.files)==null?void 0:r[0])??null})},null,32)]),l("div",null,[e[38]||(e[38]=l("label",{class:"text-sm font-semibold text-slate-700"},"Trade plates photo",-1)),l("input",{type:"file",accept:".jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[13]||(e[13]=t=>{var r;return o.trade_plate_photo=((r=t.target.files)==null?void 0:r[0])??null})},null,32)]),l("div",null,[e[39]||(e[39]=l("label",{class:"text-sm font-semibold text-slate-700"},"Utility bill (business)",-1)),l("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[14]||(e[14]=t=>{var r;return o.utility_bill=((r=t.target.files)==null?void 0:r[0])??null})},null,32)]),l("div",null,[e[40]||(e[40]=l("label",{class:"text-sm font-semibold text-slate-700"},"Director/CEO selfie",-1)),l("input",{type:"file",accept:".jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[15]||(e[15]=t=>{var r;return o.passport_selfie=((r=t.target.files)==null?void 0:r[0])??null})},null,32)])]),e[41]||(e[41]=l("p",{class:"text-xs text-slate-500"}," These documents help us verify legitimate dealership accounts and keep the marketplace secure. ",-1))])):s.role==="driver"?(p(),u("div",N,[l("div",null,[e[42]||(e[42]=l("label",{class:"text-sm font-semibold text-slate-700"},"DVLA share code",-1)),i(l("input",{"onUpdate:modelValue":e[16]||(e[16]=t=>s.driver_dvla_code=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"A1B2C3"},null,512),[[d,s.driver_dvla_code]])]),l("div",null,[e[43]||(e[43]=l("label",{class:"text-sm font-semibold text-slate-700"},"Passport number",-1)),i(l("input",{"onUpdate:modelValue":e[17]||(e[17]=t=>s.passport_number=t),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200",placeholder:"123456789"},null,512),[[d,s.passport_number]])]),l("div",O,[l("div",null,[e[44]||(e[44]=l("label",{class:"text-sm font-semibold text-slate-700"},"Utility bill (matching your name)",-1)),l("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[18]||(e[18]=t=>{var r;return o.driver_utility_bill=((r=t.target.files)==null?void 0:r[0])??null})},null,32)]),l("div",null,[e[45]||(e[45]=l("label",{class:"text-sm font-semibold text-slate-700"},"Passport photo",-1)),l("input",{type:"file",accept:".jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[19]||(e[19]=t=>{var r;return o.driver_passport=((r=t.target.files)==null?void 0:r[0])??null})},null,32)]),l("div",null,[e[46]||(e[46]=l("label",{class:"text-sm font-semibold text-slate-700"},"Driving licence (front)",-1)),l("input",{type:"file",accept:".jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[20]||(e[20]=t=>{var r;return o.driver_license_front=((r=t.target.files)==null?void 0:r[0])??null})},null,32)]),l("div",null,[e[47]||(e[47]=l("label",{class:"text-sm font-semibold text-slate-700"},"Driving licence (back)",-1)),l("input",{type:"file",accept:".jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[21]||(e[21]=t=>{var r;return o.driver_license_back=((r=t.target.files)==null?void 0:r[0])??null})},null,32)])]),l("div",G,[l("div",null,[e[48]||(e[48]=l("label",{class:"text-sm font-semibold text-slate-700"},"Selfie for verification",-1)),l("input",{type:"file",accept:".jpg,.jpeg,.png",required:"",class:"mt-1 block w-full text-sm text-slate-600 file:mr-4 file:rounded-lg file:border-0 file:bg-emerald-100 file:px-3 file:py-2 file:text-sm file:font-semibold file:text-emerald-700 hover:file:bg-emerald-200",onChange:e[22]||(e[22]=t=>{var r;return o.driver_selfie=((r=t.target.files)==null?void 0:r[0])??null})},null,32)])]),e[49]||(e[49]=l("p",{class:"text-xs text-slate-500"}," These checks help us verify driver identity and DVLA eligibility. ",-1))])):x("",!0),l("div",null,[e[51]||(e[51]=l("label",{class:"text-sm font-semibold text-slate-700"},"Membership plan",-1)),i(l("select",{"onUpdate:modelValue":e[23]||(e[23]=t=>s.plan=t),class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},[...e[50]||(e[50]=[l("option",{value:"Starter"},"Starter",-1),l("option",{value:"Gold Driver"},"Gold Driver",-1),l("option",{value:"Dealer Pro"},"Dealer Pro",-1)])],512),[[c,s.plan]]),e[52]||(e[52]=l("p",{class:"mt-1 text-xs text-slate-500"}," Starter covers the basics, Gold Driver unlocks planner tools, and Dealer Pro supports multi-site dealerships. ",-1))]),b.value?(p(),u("p",F,C(b.value),1)):x("",!0),l("button",{type:"submit",class:"w-full rounded-xl bg-emerald-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:f.value},[f.value?(p(),u("span",I,"Creating account...")):(p(),u("span",z,"Sign up"))],8,H)],32),l("p",J,[e[54]||(e[54]=w(" Already have an account? ",-1)),D(_(M),{to:"/login",class:"font-semibold text-emerald-600 hover:underline"},{default:S(()=>[...e[53]||(e[53]=[w(" Log in ",-1)])]),_:1})])]))}};export{W as default};
