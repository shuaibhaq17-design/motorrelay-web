import{u as x,q as c,r as p,o as y,a as u,b as t,g as v,s as l,v as r,t as g,m as w,p as k,k as i,x as V}from"./index-CbeUM-tk.js";const U={class:"mx-auto max-w-3xl space-y-6 rounded-2xl border bg-white p-6"},j={class:"md:col-span-2"},q={class:"md:col-span-2"},h={key:0,class:"md:col-span-2 text-sm text-red-600"},C={class:"md:col-span-2 flex justify-end"},M=["disabled"],P={key:0},D={key:1},N={__name:"JobCreate",setup(A){const f=k(),n=x(),o=c({title:"",price:"",pickup_label:"",pickup_postcode:"",dropoff_label:"",dropoff_postcode:"",distance_mi:"",vehicle_make:"",vehicle_type:"",notes:""}),a=p(!1),d=p("");async function b(){var m,e;if(!n.token){d.value="You need to log in as a dealer to create jobs.";return}a.value=!0,d.value="";try{await V.post("/jobs",o),f.push({name:"jobs"})}catch(s){console.error("Failed to create job",s),d.value=((e=(m=s.response)==null?void 0:m.data)==null?void 0:e.message)||"Could not create job. Please check the form."}finally{a.value=!1}}return y(()=>{!n.user&&n.token&&n.fetchMe().catch(()=>null)}),(m,e)=>(i(),u("div",U,[e[20]||(e[20]=t("header",null,[t("h1",{class:"text-2xl font-bold text-slate-900"},"Create a job"),t("p",{class:"text-sm text-slate-600"}," Publish a new MotorRelay run for drivers. This form posts to the Laravel API. ")],-1)),t("form",{class:"grid gap-4 md:grid-cols-2",onSubmit:w(b,["prevent"])},[t("div",j,[e[10]||(e[10]=t("label",{class:"text-sm font-semibold text-slate-700"},"Title",-1)),l(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.title=s),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.title]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"text-sm font-semibold text-slate-700"},"Price (£)",-1)),l(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.price=s),type:"number",min:"0",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.price]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-sm font-semibold text-slate-700"},"Distance (mi)",-1)),l(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.distance_mi=s),type:"number",min:"0",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.distance_mi]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"text-sm font-semibold text-slate-700"},"Pickup address",-1)),l(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.pickup_label=s),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.pickup_label]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"text-sm font-semibold text-slate-700"},"Pickup postcode",-1)),l(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.pickup_postcode=s),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.pickup_postcode]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"text-sm font-semibold text-slate-700"},"Drop-off address",-1)),l(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.dropoff_label=s),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.dropoff_label]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"text-sm font-semibold text-slate-700"},"Drop-off postcode",-1)),l(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.dropoff_postcode=s),type:"text",required:"",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.dropoff_postcode]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"text-sm font-semibold text-slate-700"},"Vehicle make",-1)),l(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.vehicle_make=s),type:"text",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.vehicle_make]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"text-sm font-semibold text-slate-700"},"Vehicle type",-1)),l(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.vehicle_type=s),type:"text",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.vehicle_type]])]),t("div",q,[e[19]||(e[19]=t("label",{class:"text-sm font-semibold text-slate-700"},"Notes",-1)),l(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.notes=s),rows:"4",placeholder:"Any special instructions for this run",class:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[r,o.notes]])]),d.value?(i(),u("p",h,g(d.value),1)):v("",!0),t("div",C,[t("button",{type:"submit",class:"rounded-xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:a.value},[a.value?(i(),u("span",P,"Creating…")):(i(),u("span",D,"Create job"))],8,M)])],32)]))}};export{N as default};
