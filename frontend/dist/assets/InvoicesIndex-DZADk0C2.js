import{u as y,r as u,o as _,a,b as e,g as h,t as o,F as m,j as v,i as f,x as b,k as l}from"./index-CbeUM-tk.js";const g={class:"space-y-4"},w={key:0,class:"text-sm text-amber-600"},k={key:1,class:"rounded-2xl border bg-white p-4 text-sm text-slate-600"},I={key:2,class:"min-w-full divide-y divide-slate-200 overflow-hidden rounded-2xl border bg-white"},S={class:"divide-y divide-slate-200 text-sm text-slate-700"},B={class:"px-4 py-3 font-semibold text-slate-900"},D={class:"px-4 py-3"},F={class:"px-4 py-3"},A={class:"px-4 py-3"},L={class:"badge bg-emerald-100 text-emerald-700"},N={class:"px-4 py-3"},M={__name:"InvoicesIndex",setup(j){const r=y(),i=u([]),c=u(!1),n=u(""),p=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",maximumFractionDigits:2});async function x(){if(!r.token){n.value="Log in to view invoices.",i.value=[];return}c.value=!0,n.value="";try{const{data:t}=await b.get("/invoices");i.value=Array.isArray(t==null?void 0:t.data)?t.data:[]}catch(t){console.error("Failed to load invoices",t),n.value="Unable to reach the invoices API. Showing sample data.",i.value=[{id:"inv-1001",total:128.5,status:"sent",issued_at:new Date().toISOString(),job_ref:"demo-1"}]}finally{c.value=!1}}return _(async()=>{!r.user&&r.token&&await r.fetchMe().catch(()=>null),x()}),(t,d)=>(l(),a("div",g,[d[1]||(d[1]=e("header",null,[e("h1",{class:"text-2xl font-bold text-slate-900"},"Invoices"),e("p",{class:"text-sm text-slate-600"}," Generate and share invoices instantly after each delivery. ")],-1)),n.value?(l(),a("p",w,o(n.value),1)):h("",!0),c.value?(l(),a("div",k," Loading invoices… ")):(l(),a("table",I,[d[0]||(d[0]=e("thead",{class:"bg-slate-50"},[e("tr",{class:"text-left text-xs font-semibold uppercase tracking-wide text-slate-500"},[e("th",{class:"px-4 py-3"},"Invoice"),e("th",{class:"px-4 py-3"},"Job"),e("th",{class:"px-4 py-3"},"Total"),e("th",{class:"px-4 py-3"},"Status"),e("th",{class:"px-4 py-3"},"Issued")])],-1)),e("tbody",S,[(l(!0),a(m,null,v(i.value,s=>(l(),a("tr",{key:s.id},[e("td",B,o(s.id),1),e("td",D,o(s.job_ref||"—"),1),e("td",F,o(f(p).format(Number(s.total??0))),1),e("td",A,[e("span",L,o(s.status||"draft"),1)]),e("td",N,o(s.issued_at?new Date(s.issued_at).toLocaleDateString():"—"),1)]))),128))])]))]))}};export{M as default};
